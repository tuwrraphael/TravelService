<html>

<head>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
        integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
        crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
        integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
        crossorigin=""></script>
    <style>
        #mapid {
            height: 40%;
        }
    </style>
</head>

<body>
    
    <div id="mapid"></div>
    <div class="text"></div>
    <input type="number" id="accuracy" value="20">
    <script type="text/javascript">
        var map = L.map('mapid').setView([48.238680, 16.452677], 13);
        // create a red polyline from an array of LatLng points
        var polyline = L.polyline([[48.23952, 16.448791],
        [48.238976, 16.451767],
        [48.238812, 16.452647],
        [48.238296, 16.453866],
        [48.237986, 16.453807]], { color: 'red' }).addTo(map);
        var denseLineCoords = [[48.2380053750009, 16.453810687479],
        [48.2380247500016, 16.4538143749609],
        [48.2380441250023, 16.4538180624455],
        [48.2380635000028, 16.453821749933],
        [48.2380828750033, 16.4538254374232],
        [48.2381022500035, 16.4538291249162],
        [48.2381216250037, 16.453832812412],
        [48.2381410000038, 16.4538364999106],
        [48.2381603750037, 16.453840187412],
        [48.2381797500035, 16.4538438749162],
        [48.2381991250032, 16.4538475624232],
        [48.2382185000028, 16.453851249933],
        [48.2382378750023, 16.4538549374455],
        [48.2382572500017, 16.4538586249609],
        [48.2382766250009, 16.4538623124791],
        [48.238296, 16.453866],
        [48.238312125195, 16.4538279066222],
        [48.2383282503775, 16.4537898132204],
        [48.2383443755473, 16.4537517197946],
        [48.2383605007046, 16.4537136263448],
        [48.2383766258493, 16.4536755328709],
        [48.2383927509814, 16.4536374393731],
        [48.238408876101, 16.4535993458512],
        [48.2384250012079, 16.4535612523053],
        [48.2384411263023, 16.4535231587354],
        [48.2384572513841, 16.4534850651415],
        [48.2384733764533, 16.4534469715236],
        [48.2384895015099, 16.4534088778817],
        [48.238505626554, 16.4533707842157],
        [48.2385217515854, 16.4533326905257],
        [48.2385378766043, 16.4532945968118],
        [48.2385540016106, 16.4532565030738],
        [48.2385701266043, 16.4532184093118],
        [48.2385862515854, 16.4531803155257],
        [48.238602376554, 16.4531422217157],
        [48.2386185015099, 16.4531041278817],
        [48.2386346264533, 16.4530660340236],
        [48.2386507513841, 16.4530279401415],
        [48.2386668763023, 16.4529898462354],
        [48.2386830012079, 16.4529517523053],
        [48.238699126101, 16.4529136583512],
        [48.2387152509814, 16.4528755643731],
        [48.2387313758493, 16.4528374703709],
        [48.2387475007046, 16.4527993763448],
        [48.2387636255474, 16.4527612822946],
        [48.2387797503775, 16.4527231882204],
        [48.238795875195, 16.4526850941222],
        [48.238812, 16.452647],
        [48.2388171251016, 16.4526195000854],
        [48.2388222501967, 16.4525920001653],
        [48.2388273752852, 16.4525645002397],
        [48.2388325003672, 16.4525370003086],
        [48.2388376254426, 16.4525095003719],
        [48.2388427505115, 16.4524820004298],
        [48.2388478755738, 16.4524545004821],
        [48.2388530006295, 16.4524270005289],
        [48.2388581256787, 16.4523995005703],
        [48.2388632507213, 16.4523720006061],
        [48.2388683757574, 16.4523445006364],
        [48.2388735007869, 16.4523170006612],
        [48.2388786258099, 16.4522895006805],
        [48.2388837508262, 16.4522620006942],
        [48.2388888758361, 16.4522345007025],
        [48.2388940008394, 16.4522070007053],
        [48.2388991258361, 16.4521795007025],
        [48.2389042508262, 16.4521520006942],
        [48.2389093758098, 16.4521245006805],
        [48.2389145007869, 16.4520970006612],
        [48.2389196257574, 16.4520695006364],
        [48.2389247507213, 16.4520420006061],
        [48.2389298756787, 16.4520145005703],
        [48.2389350006295, 16.4519870005289],
        [48.2389401255738, 16.4519595004821],
        [48.2389452505115, 16.4519320004298],
        [48.2389503754426, 16.4519045003719],
        [48.2389555003672, 16.4518770003086],
        [48.2389606252853, 16.4518495002397],
        [48.2389657501967, 16.4518220001653],
        [48.2389708751016, 16.4517945000854],
        [48.238976, 16.451767],
        [48.2389845005906, 16.4517205004868],
        [48.2389930011624, 16.4516740009581],
        [48.2390015017155, 16.4516275014139],
        [48.2390100022498, 16.4515810018543],
        [48.2390185027654, 16.4515345022792],
        [48.2390270032623, 16.4514880026887],
        [48.2390355037403, 16.4514415030828],
        [48.2390440041997, 16.4513950034613],
        [48.2390525046403, 16.4513485038245],
        [48.2390610050621, 16.4513020041721],
        [48.2390695054652, 16.4512555045044],
        [48.2390780058496, 16.4512090048211],
        [48.2390865062152, 16.4511625051225],
        [48.239095006562, 16.4511160054083],
        [48.2391035068901, 16.4510695056787],
        [48.2391120071995, 16.4510230059337],
        [48.2391205074901, 16.4509765061732],
        [48.2391290077619, 16.4509300063973],
        [48.2391375080151, 16.4508835066059],
        [48.2391460082494, 16.450837006799],
        [48.239154508465, 16.4507905069767],
        [48.2391630086619, 16.450744007139],
        [48.23917150884, 16.4506975072857],
        [48.2391800089994, 16.4506510074171],
        [48.23918850914, 16.450604507533],
        [48.2391970092619, 16.4505580076334],
        [48.239205509365, 16.4505115077184],
        [48.2392140094493, 16.4504650077879],
        [48.239222509515, 16.450418507842],
        [48.2392310095618, 16.4503720078806],
        [48.23923950959, 16.4503255079038],
        [48.2392480095993, 16.4502790079115],
        [48.23925650959, 16.4502325079038],
        [48.2392650095618, 16.4501860078806],
        [48.239273509515, 16.450139507842],
        [48.2392820094494, 16.4500930077879],
        [48.239290509365, 16.4500465077184],
        [48.2392990092619, 16.4500000076334],
        [48.23930750914, 16.4499535075329],
        [48.2393160089994, 16.449907007417],
        [48.23932450884, 16.4498605072857],
        [48.2393330086619, 16.4498140071389],
        [48.2393415084651, 16.4497675069766],
        [48.2393500082494, 16.4497210067989],
        [48.2393585080151, 16.4496745066058],
        [48.239367007762, 16.4496280063972],
        [48.2393755074901, 16.4495815061731],
        [48.2393840071995, 16.4495350059336],
        [48.2393925068902, 16.4494885056786],
        [48.2394010065621, 16.4494420054082],
        [48.2394095062152, 16.4493955051224],
        [48.2394180058496, 16.449349004821],
        [48.2394265054653, 16.4493025045043],
        [48.2394350050622, 16.449256004172],
        [48.2394435046403, 16.4492095038244],
        [48.2394520041997, 16.4491630034613],
        [48.2394605037404, 16.4491165030827],
        [48.2394690032623, 16.4490700026886],
        [48.2394775027655, 16.4490235022792],
        [48.2394860022499, 16.4489770018542],
        [48.2394945017155, 16.4489305014139],
        [48.2395030011624, 16.448884000958],
        [48.2395115005906, 16.4488375004867],
        [48.23952, 16.448791]];
        var denseLine = L.polyline(denseLineCoords, {
            color: 'blue',
            opacity: 0.5
        }).addTo(map);
        let lineCoords = [[48.2385781890964, 16.4531993624218],
        [48.238602376554, 16.4531422217157],
        [48.2386185015099, 16.4531041278817],
        [48.2386346264533, 16.4530660340236],
        [48.2386507513841, 16.4530279401415],
        [48.2386668763023, 16.4529898462354],
        [48.2386830012079, 16.4529517523053],
        [48.238699126101, 16.4529136583512],
        [48.2387152509814, 16.4528755643731],
        [48.2387313758493, 16.4528374703709],
        [48.2387475007046, 16.4527993763448],
        [48.2387636255474, 16.4527612822946],
        [48.2387797503775, 16.4527231882204],
        [48.238795875195, 16.4526850941222],
        [48.238812, 16.452647],
        [48.2388171251016, 16.4526195000854],
        [48.2388222501967, 16.4525920001653],
        [48.2388273752852, 16.4525645002397],
        [48.2388325003672, 16.4525370003086],
        [48.2388376254426, 16.4525095003719],
        [48.2388427505115, 16.4524820004298],
        [48.2388478755738, 16.4524545004821],
        [48.2388530006295, 16.4524270005289],
        [48.2388581256787, 16.4523995005703],
        [48.2388632507213, 16.4523720006061],
        [48.2388683757574, 16.4523445006364],
        [48.2388735007869, 16.4523170006612],
        [48.2388786258099, 16.4522895006805],
        [48.2388837508262, 16.4522620006942],
        [48.238886313332, 16.4522482506991]];
        var polyline = L.polyline(lineCoords, { color: 'yellow', opacity: 0.5 }).addTo(map);
        // lineCoords.forEach((l, i) => L.marker(l, { title: "index" + i }).addTo(map));
        // lineCoords.forEach((l, i) => L.marker(l, { title: "index" + i }).addTo(map));
        // L.marker([48.238680, 16.452677]).addTo(map);
        var d = L.latLng([48.2384653139203, 16.4534660183356]).distanceTo([48.2386507513841, 16.4530279401415]);
        console.log(d)
        map.fitBounds(denseLine.getBounds());
        function onMapClick(e) {
            let acc = parseInt(document.querySelector("#accuracy").value);
            console.log("You clicked the map at " + e.latlng);
            var circle = L.circle(e.latlng, { radius: acc }).addTo(map);
            fetch(`http://localhost:51511/api/Test?lat=${e.latlng.lat}&lng=${e.latlng.lng}&acc=${acc}`)
                .then(async function (res) {
                    let obj = await res.json();
                    document.querySelectorAll(".text")[0].innerHTML = `${obj.confidenceOnRoute}`; 
                });
        }

        map.on('click', onMapClick);
    </script>
</body>

</html>